<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Task</title>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#b60000;
  color:#fff;
}
.container{
  max-width:900px;
  margin:40px auto;
  background:rgba(255,255,255,0.20);
  padding:30px;
  border-radius:18px;
  backdrop-filter:blur(6px);
  text-align:center;
}
.back{
  color:#fff;
  text-decoration:none;
  font-weight:bold;
  display:inline-block;
  margin-bottom:20px;
}
h1{ margin:0; font-size:32px; }
.sub{ font-size:18px; font-weight:800; margin:10px 0 18px; }
.btn{
  display:block;
  margin:20px auto;
  padding:16px 50px;
  font-size:20px;
  font-weight:700;
  border-radius:999px;
  text-decoration:none;
  color:#3ecbff;
  background:#0a0f24;
  border:2px solid #00c2ff;
}
</style>
</head>

<body>
<div class="container">

<a class="back" id="backLink" href="equipment.html">← Back to Equipment</a>

<h1 id="taskTitle">Loading…</h1>
<div class="sub" id="eqLabel"></div>

<div id="links"></div>

</div>

<script>
/* Task definitions (edit links as needed) */
window.TASKS = {
  rif: {
    title: "Receipt Inspection Form",
    links: [
      { text: "Receipt Inspection Spreadsheet", href: "https://NEW_LINK_HERE" },
      { text: "RIF Instructions", href: "https://NEW_LINK_HERE" }
    ]
  },
  lvt: {
    title: "Megohmmeter Testing",
    links: [
      { text: "Meg Test – Line Side", href: "https://NEW_LINK_HERE" },
      { text: "Meg Test – Load Side", href: "https://NEW_LINK_HERE" }
    ]
  },
  torque: {
    title: "Torque",
    links: [
      { text: "Torque Log", href: "submit.html?form=torque" }
    ]
  }
};
</script>

<script>
  const qs = new URLSearchParams(location.search);
  const id = (qs.get("id") || "").trim();
  const eq = (qs.get("eq") || "").trim();

  const taskTitleEl = document.getElementById("taskTitle");
  const eqLabelEl = document.getElementById("eqLabel");
  const linksEl = document.getElementById("links");
  const backLink = document.getElementById("backLink");

  backLink.href = `equipment.html${eq ? `?eq=${encodeURIComponent(eq)}` : ""}`;

  if (!id || !window.TASKS || !TASKS[id]) {
    document.title = "Invalid task";
    taskTitleEl.textContent = "Invalid task";
    eqLabelEl.textContent = eq ? `Equipment: ${eq}` : "";
    throw new Error("Invalid task id or TASKS missing.");
  }

  const cfg = TASKS[id];
  document.title = cfg.title;
  taskTitleEl.textContent = cfg.title;
  eqLabelEl.textContent = eq ? `Equipment: ${eq}` : "";

  function addEqAndMaybeForm(rawHref) {
    const u = new URL(rawHref, location.href);

    if (eq) u.searchParams.set("eq", eq);

    const file = u.pathname.split("/").pop();
    if (file === "submit.html") {
      if (!u.searchParams.get("form") && !u.searchParams.get("id")) {
        u.searchParams.set("form", id);
      }
      return file + (u.search || "") + (u.hash || "");
    }

    const isInternal = file.endsWith(".html") && (u.origin === location.origin);
    if (isInternal) return file + (u.search || "") + (u.hash || "");

    return u.toString();
  }

  cfg.links.forEach(l => {
    const a = document.createElement("a");
    a.className = "btn";
    a.textContent = l.text;
    a.href = addEqAndMaybeForm(l.href);
    linksEl.appendChild(a);
  });
</script>

</body>
</html>
